<div class="container mx-auto px-4 md:py-6 py-4 w-full">
  <!-- Search -->
  <div class="mb-4">
    <app-search-bar (search)="onSearch($event)"></app-search-bar>
  </div>

  <!-- Venues grid -->
  <div class="grid gap-4 grid-cols-1 md:grid-cols-4">
    @for (venue of filteredVenues(); track venue.id) {

    <p-card class="flex flex-col min-h-md max-w-xs rounded-lg overflow-hidden relative">
      <ng-template pTemplate="header">
        <div
          class="w-full h-48 bg-center bg-cover rounded-t-lg"
          [ngStyle]="{ 'background-image': 'url(' + venue.imageUrl + ')' }"
        ></div>

        <div class="px-3 pt-3">
          <h2 class="text-lg font-semibold">{{ venue.name }}</h2>
          <p class="text-gray-600">{{ venue.location }}</p>
          <p class="text-gray-600 font-medium">{{ venue.pricePerHour }} RON/hr</p>
        </div>
      </ng-template>

      <!-- Description + AI Icon Row -->
      <div class="mb-3 flex items-start justify-between gap-2">
        @if(venue.editing()){
        <textarea class="min-w-[280px] p-2 border rounded-md" rows="3">{{
          venue.generatedDescription()
        }}</textarea>
        } @else {
        <p class="line-clamp-2 flex-1">
          {{ venue.description || 'No description available' }}
        </p>
        } @if(!venue.loading() && !venue.editing()){
        <i
          class="pi pi-sparkles text-blue-500 cursor-pointer text-xl hover:text-blue-600"
          (click)="autoGenerateDescription(venue)"
        ></i>
        } @if(venue.loading()){
        <span class="text-gray-400 text-xl">...</span>
        }
      </div>

      <div class="flex gap-2">
        @if(venue.editing()){
        <p-button
          label="Save suggestion"
          (onClick)="updateDescription(venue)"
          severity="secondary"
        ></p-button>
        }
        <p-button label="See venue" (onClick)="goToVenue(venue)"></p-button>
      </div>
    </p-card>

    } @empty {
    <p class="text-center text-gray-500">No venues available.</p>
    }
  </div>
</div>
